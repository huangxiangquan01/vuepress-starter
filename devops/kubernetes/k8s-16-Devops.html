<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <meta name="generator" content="VuePress 2.0.0-beta.67">
    <style>
      :root {
        --c-bg: #fff;
      }
      html.dark {
        --c-bg: #22272e;
      }
      html, body {
        background-color: var(--c-bg);
      }
    </style>
    <script>
      const userMode = localStorage.getItem('vuepress-color-scheme');
			const systemDarkMode = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches;
			if (userMode === 'dark' || (userMode !== 'light' && systemDarkMode)) {
				document.documentElement.classList.toggle('dark', true);
			}
    </script>
    <link rel="icon" href="/favicon.ico"><title>Devops | VuePress ！</title><meta name="description" content="这是我的第一个 VuePress 站点">
    <link rel="preload" href="/vuepress-starter/assets/style-9631a17f.css" as="style"><link rel="stylesheet" href="/vuepress-starter/assets/style-9631a17f.css">
    <link rel="modulepreload" href="/vuepress-starter/assets/app-999de8cb.js"><link rel="modulepreload" href="/vuepress-starter/assets/k8s-16-Devops.html-c98b659c.js"><link rel="modulepreload" href="/vuepress-starter/assets/k8s-16-Devops.html-2248dbdf.js"><link rel="prefetch" href="/vuepress-starter/assets/index.html-3e48afd3.js" as="script"><link rel="prefetch" href="/vuepress-starter/assets/Docker-compose命令大全.html-93eb499d.js" as="script"><link rel="prefetch" href="/vuepress-starter/assets/Docker常用命令大全.html-f3e287e3.js" as="script"><link rel="prefetch" href="/vuepress-starter/assets/Docker镜像构建.html-7d7e4c30.js" as="script"><link rel="prefetch" href="/vuepress-starter/assets/k8s-01-Kubernetes系统原理.html-9dccf374.js" as="script"><link rel="prefetch" href="/vuepress-starter/assets/k8s-03-Kubeadm搭建集群.html-a0f434da.js" as="script"><link rel="prefetch" href="/vuepress-starter/assets/k8s-04-Kubectl核心使用.html-b7221f79.js" as="script"><link rel="prefetch" href="/vuepress-starter/assets/k8s-05-Dashboard安装和使用.html-b4ef007e.js" as="script"><link rel="prefetch" href="/vuepress-starter/assets/k8s-06-Pod原理和详解.html-af85acb7.js" as="script"><link rel="prefetch" href="/vuepress-starter/assets/k8s-07-工作负载详情.html-efda3e84.js" as="script"><link rel="prefetch" href="/vuepress-starter/assets/k8s-08-服务介绍.html-ccd6b91c.js" as="script"><link rel="prefetch" href="/vuepress-starter/assets/k8s-09-Ingress.html-390ccaf5.js" as="script"><link rel="prefetch" href="/vuepress-starter/assets/k8s-10-Storage.html-6e04cf17.js" as="script"><link rel="prefetch" href="/vuepress-starter/assets/k8s-11-集群配置默认存储类.html-b26ea5f4.js" as="script"><link rel="prefetch" href="/vuepress-starter/assets/k8s-12-Configmap和Secret.html-90e577e4.js" as="script"><link rel="prefetch" href="/vuepress-starter/assets/k8s-13-HorizontalPodAutoscaler.html-8899a225.js" as="script"><link rel="prefetch" href="/vuepress-starter/assets/k8s-14-创建并部署WordPress.html-104e8204.js" as="script"><link rel="prefetch" href="/vuepress-starter/assets/k8s-15-部署中间件.html-47c1520e.js" as="script"><link rel="prefetch" href="/vuepress-starter/assets/k8s-17-Istio基本介绍.html-adf5b5c0.js" as="script"><link rel="prefetch" href="/vuepress-starter/assets/字典树.html-e2c6ee6a.js" as="script"><link rel="prefetch" href="/vuepress-starter/assets/常用10种算法.html-5b8b9a70.js" as="script"><link rel="prefetch" href="/vuepress-starter/assets/排序算法.html-701197dc.js" as="script"><link rel="prefetch" href="/vuepress-starter/assets/AQS工具类.html-bca75b08.js" as="script"><link rel="prefetch" href="/vuepress-starter/assets/Atomic和Unsafe.html-1c37fa28.js" as="script"><link rel="prefetch" href="/vuepress-starter/assets/CPU缓存一致性协议MESI.html-f077c1c5.js" as="script"><link rel="prefetch" href="/vuepress-starter/assets/Collections.html-b8e8c729.js" as="script"><link rel="prefetch" href="/vuepress-starter/assets/Executor线程池.html-ce612aa5.js" as="script"><link rel="prefetch" href="/vuepress-starter/assets/Future_ForkJoin.html-fa843369.js" as="script"><link rel="prefetch" href="/vuepress-starter/assets/Java内存模型.html-1c30a945.js" as="script"><link rel="prefetch" href="/vuepress-starter/assets/Synchronized.html-ac25c50f.js" as="script"><link rel="prefetch" href="/vuepress-starter/assets/抽象队列同步器AQS.html-9d1d4326.js" as="script"><link rel="prefetch" href="/vuepress-starter/assets/操作系统底层的整体认识.html-9ac36108.js" as="script"><link rel="prefetch" href="/vuepress-starter/assets/Java设计模式.html-7f13f31c.js" as="script"><link rel="prefetch" href="/vuepress-starter/assets/JVM内存模型.html-77ac90db.js" as="script"><link rel="prefetch" href="/vuepress-starter/assets/JVM对象创建和内存分配.html-4da68e3a.js" as="script"><link rel="prefetch" href="/vuepress-starter/assets/JVM类加载机制.html-d5eacc9b.js" as="script"><link rel="prefetch" href="/vuepress-starter/assets/垃圾收集器G1和ZGC.html-6331579d.js" as="script"><link rel="prefetch" href="/vuepress-starter/assets/垃圾收集器ParNew和CMS.html-270444fe.js" as="script"><link rel="prefetch" href="/vuepress-starter/assets/中介者模式.html-adab21e6.js" as="script"><link rel="prefetch" href="/vuepress-starter/assets/命令模式.html-1320181f.js" as="script"><link rel="prefetch" href="/vuepress-starter/assets/备忘录模式.html-02606526.js" as="script"><link rel="prefetch" href="/vuepress-starter/assets/模板模式.html-3e94ee87.js" as="script"><link rel="prefetch" href="/vuepress-starter/assets/状态模式.html-a7df6975.js" as="script"><link rel="prefetch" href="/vuepress-starter/assets/策略模式.html-3e7ccbc8.js" as="script"><link rel="prefetch" href="/vuepress-starter/assets/观察者模式.html-1ce60350.js" as="script"><link rel="prefetch" href="/vuepress-starter/assets/解释器模式.html-a12c04bf.js" as="script"><link rel="prefetch" href="/vuepress-starter/assets/访问者模式.html-8abb08b5.js" as="script"><link rel="prefetch" href="/vuepress-starter/assets/责任链模式.html-aac04461.js" as="script"><link rel="prefetch" href="/vuepress-starter/assets/迭代器模式.html-3e4eb5b7.js" as="script"><link rel="prefetch" href="/vuepress-starter/assets/单例模式.html-db73cadd.js" as="script"><link rel="prefetch" href="/vuepress-starter/assets/原型模式.html-460cbe27.js" as="script"><link rel="prefetch" href="/vuepress-starter/assets/工厂模式.html-350ff1b7.js" as="script"><link rel="prefetch" href="/vuepress-starter/assets/建造者模式.html-cb877207.js" as="script"><link rel="prefetch" href="/vuepress-starter/assets/抽象工厂模式.html-4ae2d885.js" as="script"><link rel="prefetch" href="/vuepress-starter/assets/享元模式.html-e45e53dd.js" as="script"><link rel="prefetch" href="/vuepress-starter/assets/代理模式.html-8e1b3a0e.js" as="script"><link rel="prefetch" href="/vuepress-starter/assets/外观模式.html-a69f5545.js" as="script"><link rel="prefetch" href="/vuepress-starter/assets/桥接模式.html-53c942e8.js" as="script"><link rel="prefetch" href="/vuepress-starter/assets/组合模式.html-d7b5c1c4.js" as="script"><link rel="prefetch" href="/vuepress-starter/assets/装饰器模式.html-4d7645dc.js" as="script"><link rel="prefetch" href="/vuepress-starter/assets/适配器模式.html-e84d0f15.js" as="script"><link rel="prefetch" href="/vuepress-starter/assets/404.html-f9875e7b.js" as="script"><link rel="prefetch" href="/vuepress-starter/assets/index.html-ed3383e4.js" as="script"><link rel="prefetch" href="/vuepress-starter/assets/Docker-compose命令大全.html-2a0e4dba.js" as="script"><link rel="prefetch" href="/vuepress-starter/assets/Docker常用命令大全.html-d79b09e2.js" as="script"><link rel="prefetch" href="/vuepress-starter/assets/Docker镜像构建.html-9df2a948.js" as="script"><link rel="prefetch" href="/vuepress-starter/assets/k8s-01-Kubernetes系统原理.html-e458650d.js" as="script"><link rel="prefetch" href="/vuepress-starter/assets/k8s-03-Kubeadm搭建集群.html-725522cd.js" as="script"><link rel="prefetch" href="/vuepress-starter/assets/k8s-04-Kubectl核心使用.html-9f1e9afa.js" as="script"><link rel="prefetch" href="/vuepress-starter/assets/k8s-05-Dashboard安装和使用.html-839ddae0.js" as="script"><link rel="prefetch" href="/vuepress-starter/assets/k8s-06-Pod原理和详解.html-3e166721.js" as="script"><link rel="prefetch" href="/vuepress-starter/assets/k8s-07-工作负载详情.html-918c6c68.js" as="script"><link rel="prefetch" href="/vuepress-starter/assets/k8s-08-服务介绍.html-4aad69bb.js" as="script"><link rel="prefetch" href="/vuepress-starter/assets/k8s-09-Ingress.html-8740ccf8.js" as="script"><link rel="prefetch" href="/vuepress-starter/assets/k8s-10-Storage.html-c6314a04.js" as="script"><link rel="prefetch" href="/vuepress-starter/assets/k8s-11-集群配置默认存储类.html-abf0f6d3.js" as="script"><link rel="prefetch" href="/vuepress-starter/assets/k8s-12-Configmap和Secret.html-3e5046e2.js" as="script"><link rel="prefetch" href="/vuepress-starter/assets/k8s-13-HorizontalPodAutoscaler.html-7b61da35.js" as="script"><link rel="prefetch" href="/vuepress-starter/assets/k8s-14-创建并部署WordPress.html-e5acb658.js" as="script"><link rel="prefetch" href="/vuepress-starter/assets/k8s-15-部署中间件.html-e51d13e7.js" as="script"><link rel="prefetch" href="/vuepress-starter/assets/k8s-17-Istio基本介绍.html-f5e59953.js" as="script"><link rel="prefetch" href="/vuepress-starter/assets/字典树.html-2c7285a6.js" as="script"><link rel="prefetch" href="/vuepress-starter/assets/常用10种算法.html-17a1c49f.js" as="script"><link rel="prefetch" href="/vuepress-starter/assets/排序算法.html-95e4dbce.js" as="script"><link rel="prefetch" href="/vuepress-starter/assets/AQS工具类.html-77fb2478.js" as="script"><link rel="prefetch" href="/vuepress-starter/assets/Atomic和Unsafe.html-06dfb1a4.js" as="script"><link rel="prefetch" href="/vuepress-starter/assets/CPU缓存一致性协议MESI.html-dcabccb4.js" as="script"><link rel="prefetch" href="/vuepress-starter/assets/Collections.html-655c9984.js" as="script"><link rel="prefetch" href="/vuepress-starter/assets/Executor线程池.html-0b5f0c4a.js" as="script"><link rel="prefetch" href="/vuepress-starter/assets/Future_ForkJoin.html-c27a14af.js" as="script"><link rel="prefetch" href="/vuepress-starter/assets/Java内存模型.html-3f3ce9c0.js" as="script"><link rel="prefetch" href="/vuepress-starter/assets/Synchronized.html-c7bad751.js" as="script"><link rel="prefetch" href="/vuepress-starter/assets/抽象队列同步器AQS.html-54b969ae.js" as="script"><link rel="prefetch" href="/vuepress-starter/assets/操作系统底层的整体认识.html-7af80a08.js" as="script"><link rel="prefetch" href="/vuepress-starter/assets/Java设计模式.html-4585117b.js" as="script"><link rel="prefetch" href="/vuepress-starter/assets/JVM内存模型.html-a4e8e02a.js" as="script"><link rel="prefetch" href="/vuepress-starter/assets/JVM对象创建和内存分配.html-b3baf044.js" as="script"><link rel="prefetch" href="/vuepress-starter/assets/JVM类加载机制.html-47e18e2c.js" as="script"><link rel="prefetch" href="/vuepress-starter/assets/垃圾收集器G1和ZGC.html-370e712a.js" as="script"><link rel="prefetch" href="/vuepress-starter/assets/垃圾收集器ParNew和CMS.html-0b2a9e5f.js" as="script"><link rel="prefetch" href="/vuepress-starter/assets/中介者模式.html-88a3afb3.js" as="script"><link rel="prefetch" href="/vuepress-starter/assets/命令模式.html-0bace85b.js" as="script"><link rel="prefetch" href="/vuepress-starter/assets/备忘录模式.html-98b5d718.js" as="script"><link rel="prefetch" href="/vuepress-starter/assets/模板模式.html-a1a3122a.js" as="script"><link rel="prefetch" href="/vuepress-starter/assets/状态模式.html-1d50687c.js" as="script"><link rel="prefetch" href="/vuepress-starter/assets/策略模式.html-544dd235.js" as="script"><link rel="prefetch" href="/vuepress-starter/assets/观察者模式.html-4b21f482.js" as="script"><link rel="prefetch" href="/vuepress-starter/assets/解释器模式.html-cdfb208c.js" as="script"><link rel="prefetch" href="/vuepress-starter/assets/访问者模式.html-2b7948bf.js" as="script"><link rel="prefetch" href="/vuepress-starter/assets/责任链模式.html-350335a1.js" as="script"><link rel="prefetch" href="/vuepress-starter/assets/迭代器模式.html-4f2e1555.js" as="script"><link rel="prefetch" href="/vuepress-starter/assets/单例模式.html-4e5f5e21.js" as="script"><link rel="prefetch" href="/vuepress-starter/assets/原型模式.html-3a79c02a.js" as="script"><link rel="prefetch" href="/vuepress-starter/assets/工厂模式.html-817019fa.js" as="script"><link rel="prefetch" href="/vuepress-starter/assets/建造者模式.html-76aa3e09.js" as="script"><link rel="prefetch" href="/vuepress-starter/assets/抽象工厂模式.html-f519b0c7.js" as="script"><link rel="prefetch" href="/vuepress-starter/assets/享元模式.html-a461053e.js" as="script"><link rel="prefetch" href="/vuepress-starter/assets/代理模式.html-7393c115.js" as="script"><link rel="prefetch" href="/vuepress-starter/assets/外观模式.html-99ee7d35.js" as="script"><link rel="prefetch" href="/vuepress-starter/assets/桥接模式.html-1eaaaca9.js" as="script"><link rel="prefetch" href="/vuepress-starter/assets/组合模式.html-d68ec25b.js" as="script"><link rel="prefetch" href="/vuepress-starter/assets/装饰器模式.html-dba31b7c.js" as="script"><link rel="prefetch" href="/vuepress-starter/assets/适配器模式.html-a07dfe6c.js" as="script"><link rel="prefetch" href="/vuepress-starter/assets/404.html-38d245cb.js" as="script">
  </head>
  <body>
    <div id="app"><!--[--><div class="theme-container"><!--[--><header class="navbar"><div class="toggle-sidebar-button" title="toggle sidebar" aria-expanded="false" role="button" tabindex="0"><div class="icon" aria-hidden="true"><span></span><span></span><span></span></div></div><span><a href="/vuepress-starter/" class=""><!----><span class="site-name">VuePress ！</span></a></span><div class="navbar-items-wrapper" style=""><!--[--><!--]--><nav class="navbar-items can-hide"><!--[--><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="Java"><span class="title">Java</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="Java"><span class="title">Java</span><span class="right arrow"></span></button><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a href="/vuepress-starter/java/jvm/JVM内存模型.md" class="" aria-label="Jvm"><!--[--><!--]--> Jvm <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/vuepress-starter/java/arithmetic/字典树.md" class="" aria-label="数据结构与算法"><!--[--><!--]--> 数据结构与算法 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/vuepress-starter/java/concurrent/操作系统底层的整体认识.md" class="" aria-label="并发编程"><!--[--><!--]--> 并发编程 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><!--[--><h4 class="navbar-dropdown-subtitle"><a href="/vuepress-starter/java/design/Java设计模式.md" class="" aria-label="设计模式"><!--[--><!--]--> 设计模式 <!--[--><!--]--></a></h4><ul class="navbar-dropdown-subitem-wrapper"><!--[--><li class="navbar-dropdown-subitem"><a href="/vuepress-starter/java/design/build/单例模式.md" class="" aria-label="创建型模式"><!--[--><!--]--> 创建型模式 <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/vuepress-starter/java/design/structure/享元模式.md" class="" aria-label="结构型模式"><!--[--><!--]--> 结构型模式 <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/vuepress-starter/java/design/action/中介者模式.md" class="" aria-label="行为型模式"><!--[--><!--]--> 行为型模式 <!--[--><!--]--></a></li><!--]--></ul><!--]--></li><!--]--></ul></div></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="Devops"><span class="title">Devops</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="Devops"><span class="title">Devops</span><span class="right arrow"></span></button><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a href="/vuepress-starter/devops/docker/Docker常用命令大全.md" class="" aria-label="docker"><!--[--><!--]--> docker <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/vuepress-starter/devops/kubernetes/k8s-01-Kubernetes系统原理.md" class="" aria-label="kubernetes"><!--[--><!--]--> kubernetes <!--[--><!--]--></a></li><!--]--></ul></div></div><!--]--></nav><!--[--><!--]--><button class="toggle-color-mode-button" title="toggle color mode"><svg style="" class="icon" focusable="false" viewBox="0 0 32 32"><path d="M16 12.005a4 4 0 1 1-4 4a4.005 4.005 0 0 1 4-4m0-2a6 6 0 1 0 6 6a6 6 0 0 0-6-6z" fill="currentColor"></path><path d="M5.394 6.813l1.414-1.415l3.506 3.506L8.9 10.318z" fill="currentColor"></path><path d="M2 15.005h5v2H2z" fill="currentColor"></path><path d="M5.394 25.197L8.9 21.691l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 25.005h2v5h-2z" fill="currentColor"></path><path d="M21.687 23.106l1.414-1.415l3.506 3.506l-1.414 1.414z" fill="currentColor"></path><path d="M25 15.005h5v2h-5z" fill="currentColor"></path><path d="M21.687 8.904l3.506-3.506l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 2.005h2v5h-2z" fill="currentColor"></path></svg><svg style="display:none;" class="icon" focusable="false" viewBox="0 0 32 32"><path d="M13.502 5.414a15.075 15.075 0 0 0 11.594 18.194a11.113 11.113 0 0 1-7.975 3.39c-.138 0-.278.005-.418 0a11.094 11.094 0 0 1-3.2-21.584M14.98 3a1.002 1.002 0 0 0-.175.016a13.096 13.096 0 0 0 1.825 25.981c.164.006.328 0 .49 0a13.072 13.072 0 0 0 10.703-5.555a1.01 1.01 0 0 0-.783-1.565A13.08 13.08 0 0 1 15.89 4.38A1.015 1.015 0 0 0 14.98 3z" fill="currentColor"></path></svg></button><!----></div></header><!--]--><div class="sidebar-mask"></div><!--[--><aside class="sidebar"><nav class="navbar-items"><!--[--><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="Java"><span class="title">Java</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="Java"><span class="title">Java</span><span class="right arrow"></span></button><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a href="/vuepress-starter/java/jvm/JVM内存模型.md" class="" aria-label="Jvm"><!--[--><!--]--> Jvm <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/vuepress-starter/java/arithmetic/字典树.md" class="" aria-label="数据结构与算法"><!--[--><!--]--> 数据结构与算法 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/vuepress-starter/java/concurrent/操作系统底层的整体认识.md" class="" aria-label="并发编程"><!--[--><!--]--> 并发编程 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><!--[--><h4 class="navbar-dropdown-subtitle"><a href="/vuepress-starter/java/design/Java设计模式.md" class="" aria-label="设计模式"><!--[--><!--]--> 设计模式 <!--[--><!--]--></a></h4><ul class="navbar-dropdown-subitem-wrapper"><!--[--><li class="navbar-dropdown-subitem"><a href="/vuepress-starter/java/design/build/单例模式.md" class="" aria-label="创建型模式"><!--[--><!--]--> 创建型模式 <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/vuepress-starter/java/design/structure/享元模式.md" class="" aria-label="结构型模式"><!--[--><!--]--> 结构型模式 <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/vuepress-starter/java/design/action/中介者模式.md" class="" aria-label="行为型模式"><!--[--><!--]--> 行为型模式 <!--[--><!--]--></a></li><!--]--></ul><!--]--></li><!--]--></ul></div></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="Devops"><span class="title">Devops</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="Devops"><span class="title">Devops</span><span class="right arrow"></span></button><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a href="/vuepress-starter/devops/docker/Docker常用命令大全.md" class="" aria-label="docker"><!--[--><!--]--> docker <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/vuepress-starter/devops/kubernetes/k8s-01-Kubernetes系统原理.md" class="" aria-label="kubernetes"><!--[--><!--]--> kubernetes <!--[--><!--]--></a></li><!--]--></ul></div></div><!--]--></nav><!--[--><!--]--><ul class="sidebar-items"><!--[--><li><p tabindex="0" class="sidebar-item sidebar-heading active">kubernetes <!----></p><ul style="" class="sidebar-item-children"><!--[--><li><a href="/vuepress-starter/devops/kubernetes/k8s-01-Kubernetes%E7%B3%BB%E7%BB%9F%E5%8E%9F%E7%90%86.html" class="sidebar-item" aria-label="kubenertes系统原理"><!--[--><!--]--> kubenertes系统原理 <!--[--><!--]--></a><!----></li><li><a href="/vuepress-starter/devops/kubernetes/k8s-03-Kubeadm%E6%90%AD%E5%BB%BA%E9%9B%86%E7%BE%A4.html" class="sidebar-item" aria-label="k8s 集群搭建"><!--[--><!--]--> k8s 集群搭建 <!--[--><!--]--></a><!----></li><li><a href="/vuepress-starter/devops/kubernetes/k8s-04-Kubectl%E6%A0%B8%E5%BF%83%E4%BD%BF%E7%94%A8.html" class="sidebar-item" aria-label="kubectl"><!--[--><!--]--> kubectl <!--[--><!--]--></a><!----></li><li><a href="/vuepress-starter/devops/kubernetes/k8s-05-Dashboard%E5%AE%89%E8%A3%85%E5%92%8C%E4%BD%BF%E7%94%A8.html" class="sidebar-item" aria-label="Dashboard"><!--[--><!--]--> Dashboard <!--[--><!--]--></a><!----></li><li><a href="/vuepress-starter/devops/kubernetes/k8s-06-Pod%E5%8E%9F%E7%90%86%E5%92%8C%E8%AF%A6%E8%A7%A3.html" class="sidebar-item" aria-label="Kubernetes Pod"><!--[--><!--]--> Kubernetes Pod <!--[--><!--]--></a><!----></li><li><a href="/vuepress-starter/devops/kubernetes/k8s-03-Kubeadm%E6%90%AD%E5%BB%BA%E9%9B%86%E7%BE%A4.html" class="sidebar-item" aria-label="k8s 集群搭建"><!--[--><!--]--> k8s 集群搭建 <!--[--><!--]--></a><!----></li><li><a href="/vuepress-starter/devops/kubernetes/k8s-07-%E5%B7%A5%E4%BD%9C%E8%B4%9F%E8%BD%BD%E8%AF%A6%E6%83%85.html" class="sidebar-item" aria-label="K8s Pod 控制器"><!--[--><!--]--> K8s Pod 控制器 <!--[--><!--]--></a><!----></li><li><a href="/vuepress-starter/devops/kubernetes/k8s-08-%E6%9C%8D%E5%8A%A1%E4%BB%8B%E7%BB%8D.html" class="sidebar-item" aria-label="08 服务介绍"><!--[--><!--]--> 08 服务介绍 <!--[--><!--]--></a><!----></li><li><a href="/vuepress-starter/devops/kubernetes/k8s-09-Ingress.html" class="sidebar-item" aria-label="09.K8s Ingress and 网络"><!--[--><!--]--> 09.K8s Ingress and 网络 <!--[--><!--]--></a><!----></li><li><a href="/vuepress-starter/devops/kubernetes/k8s-10-Storage.html" class="sidebar-item" aria-label="10 .K8s 存储"><!--[--><!--]--> 10 .K8s 存储 <!--[--><!--]--></a><!----></li><li><a href="/vuepress-starter/devops/kubernetes/k8s-11-%E9%9B%86%E7%BE%A4%E9%85%8D%E7%BD%AE%E9%BB%98%E8%AE%A4%E5%AD%98%E5%82%A8%E7%B1%BB.html" class="sidebar-item" aria-label="/devops/kubernetes/k8s-11-集群配置默认存储类.md"><!--[--><!--]--> /devops/kubernetes/k8s-11-集群配置默认存储类.md <!--[--><!--]--></a><!----></li><li><a href="/vuepress-starter/devops/kubernetes/k8s-12-Configmap%E5%92%8CSecret.html" class="sidebar-item" aria-label="Configmap and Secret"><!--[--><!--]--> Configmap and Secret <!--[--><!--]--></a><!----></li><li><a href="/vuepress-starter/devops/kubernetes/k8s-13-HorizontalPodAutoscaler.html" class="sidebar-item" aria-label="应用自动弹性伸缩-HPA"><!--[--><!--]--> 应用自动弹性伸缩-HPA <!--[--><!--]--></a><!----></li><li><a href="/vuepress-starter/devops/kubernetes/k8s-14-%E5%88%9B%E5%BB%BA%E5%B9%B6%E9%83%A8%E7%BD%B2WordPress.html" class="sidebar-item" aria-label="创建并部署 WordPress"><!--[--><!--]--> 创建并部署 WordPress <!--[--><!--]--></a><!----></li><li><a href="/vuepress-starter/devops/kubernetes/k8s-15-%E9%83%A8%E7%BD%B2%E4%B8%AD%E9%97%B4%E4%BB%B6.html" class="sidebar-item" aria-label="部署中间件"><!--[--><!--]--> 部署中间件 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/vuepress-starter/devops/kubernetes/k8s-16-Devops.html" class="router-link-active router-link-exact-active router-link-active sidebar-item active" aria-label="Devops"><!--[--><!--]--> Devops <!--[--><!--]--></a><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/vuepress-starter/devops/kubernetes/k8s-16-Devops.html#一、devops、ci、cd" class="router-link-active router-link-exact-active sidebar-item" aria-label="一、Devops、CI、CD"><!--[--><!--]--> 一、Devops、CI、CD <!--[--><!--]--></a><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/vuepress-starter/devops/kubernetes/k8s-16-Devops.html#_1-agile-development" class="router-link-active router-link-exact-active sidebar-item" aria-label="1.Agile Development"><!--[--><!--]--> 1.Agile Development <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/vuepress-starter/devops/kubernetes/k8s-16-Devops.html#_2-ci-持续集成" class="router-link-active router-link-exact-active sidebar-item" aria-label="2.CI-持续集成"><!--[--><!--]--> 2.CI-持续集成 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/vuepress-starter/devops/kubernetes/k8s-16-Devops.html#_3-cd" class="router-link-active router-link-exact-active sidebar-item" aria-label="3.CD"><!--[--><!--]--> 3.CD <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/vuepress-starter/devops/kubernetes/k8s-16-Devops.html#_4-devops" class="router-link-active router-link-exact-active sidebar-item" aria-label="4.DevOps"><!--[--><!--]--> 4.DevOps <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><a aria-current="page" href="/vuepress-starter/devops/kubernetes/k8s-16-Devops.html#二、jenkins-部署和基本使用" class="router-link-active router-link-exact-active sidebar-item" aria-label="二、Jenkins 部署和基本使用"><!--[--><!--]--> 二、Jenkins 部署和基本使用 <!--[--><!--]--></a><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/vuepress-starter/devops/kubernetes/k8s-16-Devops.html#_1-简介" class="router-link-active router-link-exact-active sidebar-item" aria-label="1. 简介"><!--[--><!--]--> 1. 简介 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/vuepress-starter/devops/kubernetes/k8s-16-Devops.html#_2-jenkins-部署环境" class="router-link-active router-link-exact-active sidebar-item" aria-label="2. Jenkins 部署环境"><!--[--><!--]--> 2. Jenkins 部署环境 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/vuepress-starter/devops/kubernetes/k8s-16-Devops.html#_3-jenkins-初始化配置" class="router-link-active router-link-exact-active sidebar-item" aria-label="3.Jenkins 初始化配置"><!--[--><!--]--> 3.Jenkins 初始化配置 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/vuepress-starter/devops/kubernetes/k8s-16-Devops.html#_4-jenkin-构建环境配置" class="router-link-active router-link-exact-active sidebar-item" aria-label="4.Jenkin 构建环境配置"><!--[--><!--]--> 4.Jenkin 构建环境配置 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/vuepress-starter/devops/kubernetes/k8s-16-Devops.html#_5-测试上述" class="router-link-active router-link-exact-active sidebar-item" aria-label="5.测试上述"><!--[--><!--]--> 5.测试上述 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/vuepress-starter/devops/kubernetes/k8s-16-Devops.html#_6-图形化界面-blueocean" class="router-link-active router-link-exact-active sidebar-item" aria-label="6.图形化界面 BlueOcean"><!--[--><!--]--> 6.图形化界面 BlueOcean <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><a aria-current="page" href="/vuepress-starter/devops/kubernetes/k8s-16-Devops.html#三-jenkins-pipeline" class="router-link-active router-link-exact-active sidebar-item" aria-label="三.Jenkins Pipeline"><!--[--><!--]--> 三.Jenkins Pipeline <!--[--><!--]--></a><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/vuepress-starter/devops/kubernetes/k8s-16-Devops.html#_1-pipeline-特性-pipeline-as-code" class="router-link-active router-link-exact-active sidebar-item" aria-label="1.Pipeline 特性 - Pipeline As Code"><!--[--><!--]--> 1.Pipeline 特性 - Pipeline As Code <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/vuepress-starter/devops/kubernetes/k8s-16-Devops.html#_2-pipeline-基本概念" class="router-link-active router-link-exact-active sidebar-item" aria-label="2.Pipeline 基本概念"><!--[--><!--]--> 2.Pipeline 基本概念 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/vuepress-starter/devops/kubernetes/k8s-16-Devops.html#_3-scripted-pipeline" class="router-link-active router-link-exact-active sidebar-item" aria-label="3.Scripted Pipeline"><!--[--><!--]--> 3.Scripted Pipeline <!--[--><!--]--></a><!----></li><!--]--></ul></li><!--]--></ul></li><li><a href="/vuepress-starter/devops/kubernetes/k8s-17-Istio%E5%9F%BA%E6%9C%AC%E4%BB%8B%E7%BB%8D.html" class="sidebar-item" aria-label="Istio 入门"><!--[--><!--]--> Istio 入门 <!--[--><!--]--></a><!----></li><!--]--></ul></li><!--]--></ul><!--[--><!--]--></aside><!--]--><!--[--><main class="page"><!--[--><!--]--><div class="theme-default-content"><!--[--><!--]--><div><h1 id="devops" tabindex="-1"><a class="header-anchor" href="#devops" aria-hidden="true">#</a> Devops</h1><h2 id="一、devops、ci、cd" tabindex="-1"><a class="header-anchor" href="#一、devops、ci、cd" aria-hidden="true">#</a> 一、Devops、CI、CD</h2><h3 id="_1-agile-development" tabindex="-1"><a class="header-anchor" href="#_1-agile-development" aria-hidden="true">#</a> 1.Agile Development</h3><p>敏捷开发以用户的需求进化为核心，采用迭代、循序渐进的方法进行软件开发。在敏捷开发中，软件项目在构建初期被切分成多个子项目，各个子项目的成果都经过测试，具备可视、可集成和可运行使用的特征。换言之，就是把一个大项目分为多个相互联系，但也可独立运行的小项目，并分别完成，在此过程中软件一直处于可使用状态。</p><h3 id="_2-ci-持续集成" tabindex="-1"><a class="header-anchor" href="#_2-ci-持续集成" aria-hidden="true">#</a> 2.CI-<strong>持续集成</strong></h3><p>CI 的英文名称是 Continuous Integration，中文翻译为：持续集成。</p><p>CI 中，开发人员将会频繁地向主干提交代码，这些新提交的代码在最终合并到主干前，需要经过编译和自动化测试流进行验证。持续集成（CI）是在源代码变更后自动检测、拉取、构建和（在大多数情况下）进行单元测试的过程。持续集成的目标是快速确保开发人员新提交的变更是好的，并且适合在代码库中进一步使用。CI 的流程执行和理论实践让我们可以确定新代码和原有代码能否正确地集成在一起。</p><h3 id="_3-cd" tabindex="-1"><a class="header-anchor" href="#_3-cd" aria-hidden="true">#</a> 3.CD</h3><p>CD 可对应多个英文名称，持续交付 Continuous Delivery 和持续部署 Continuous Deployment</p><h4 id="持续交付" tabindex="-1"><a class="header-anchor" href="#持续交付" aria-hidden="true">#</a> 持续交付</h4><p>完成 CI 中构建及单元测试和集成测试的自动化流程后，持续交付可自动将已验证的代码发布到存储库。为了实现高效的持续交付流程，务必要确保 CI 已内置于开发管道。持续交付的目标是拥有一个可随时部署到生产环境的代码库。在持续交付中，每个阶段（从代码更改的合并，到生产就绪型构建版本的交付）都涉及测试自动化和代码发布自动化。在流程结束时，运维团队可以快速、轻松地将应用部署到生产环境中或发布给最终使用的用户。</p><h4 id="持续部署" tabindex="-1"><a class="header-anchor" href="#持续部署" aria-hidden="true">#</a> 持续部署</h4><p>对于一个成熟的 CI/CD 管道（Pipeline）来说，最后的阶段是持续部署。作为持续交付— —自动将生产就绪型构建版本发布到代码存储库——的延伸，持续部署可以自动将应用发布到生产环境。持续部署意味着所有的变更都会被自动部署到生产环境中。</p><p>持续交付意味着所有的变更都可以被部署到生产环境中，但是出于业务考虑，可以选择不部署。如果要实施持续部署，必须先实施持续交付。持续交付并不是指软件每一个改动都要尽快部署到产品环境中，它指的是任何的代码修改都可以在任何时候实施部署。持续交付表示的是一种能力，而持续部署表示的则一种方式。持续部署是持续交付的最高阶段。</p><h3 id="_4-devops" tabindex="-1"><a class="header-anchor" href="#_4-devops" aria-hidden="true">#</a> 4.DevOps</h3><p>DevOps 是 Development 和 Operations 的组合，是一种方法论，是一组过程、方法与系统的统称，用于促进应用开发、应用运维和质量保障（QA）部门之间的沟通、协作与整合。以期打破传统开发和运营之间的壁垒和鸿沟。</p><h2 id="二、jenkins-部署和基本使用" tabindex="-1"><a class="header-anchor" href="#二、jenkins-部署和基本使用" aria-hidden="true">#</a> 二、Jenkins 部署和基本使用</h2><h3 id="_1-简介" tabindex="-1"><a class="header-anchor" href="#_1-简介" aria-hidden="true">#</a> <strong>1. 简介</strong></h3><p>Jenkins 是一个开源软件项目，是基于 Java 开发的一种持续集成工具，用于监控持续重复的工作，旨在提供一个开放易用的软件平台，使软件的持续集成变成可能。当然除了 Jenkins 以外，也还有其他的工具可以实现自动化部署，如 Hudson 等 只是Jenkins 相对来说，使用得更广泛。</p><h3 id="_2-jenkins-部署环境" tabindex="-1"><a class="header-anchor" href="#_2-jenkins-部署环境" aria-hidden="true">#</a> <strong>2. Jenkins 部署环境</strong></h3><blockquote><p><strong>基本环境</strong>：</p><ol><li><p>jdk 环境，Jenkins 是 java 语言开发的，因需要 jdk 环境。</p></li><li><p>git/svn 客户端，因一般代码是放在 git/svn 服务器上的，我们需要拉取代码。</p></li><li><p>maven 客户端，因一般 java 程序是由 maven 工程，需要 maven 打包，当然也有其他打包方式，如：gradle</p></li></ol></blockquote><h4 id="pvc-创建" tabindex="-1"><a class="header-anchor" href="#pvc-创建" aria-hidden="true">#</a> <strong>PVC 创建</strong></h4><p><strong>创建命名空间</strong></p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>kubectl create namespace jenkins-k8s
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><div class="language-yaml line-numbers-mode" data-ext="yml"><pre class="language-yaml"><code><span class="token key atrule">kind</span><span class="token punctuation">:</span> PersistentVolumeClaim
<span class="token key atrule">apiVersion</span><span class="token punctuation">:</span> v1
<span class="token key atrule">metadata</span><span class="token punctuation">:</span>
  <span class="token key atrule">name</span><span class="token punctuation">:</span> jenkins<span class="token punctuation">-</span>pvc
  <span class="token key atrule">namespace</span><span class="token punctuation">:</span> jenkins<span class="token punctuation">-</span>k8s
<span class="token key atrule">spec</span><span class="token punctuation">:</span>
  <span class="token key atrule">resources</span><span class="token punctuation">:</span>
    <span class="token key atrule">requests</span><span class="token punctuation">:</span>
      <span class="token key atrule">storage</span><span class="token punctuation">:</span> 10Gi
  <span class="token key atrule">accessModes</span><span class="token punctuation">:</span>
    <span class="token punctuation">-</span> ReadWriteMany
  <span class="token key atrule">storageClassName</span><span class="token punctuation">:</span> nfs
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="serviceaccount" tabindex="-1"><a class="header-anchor" href="#serviceaccount" aria-hidden="true">#</a> <strong>ServiceAccount</strong></h4><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token comment"># 创建一个 sa 账号</span>
kubectl create sa jenkins-k8s-sa <span class="token parameter variable">-n</span> jenkins-k8s
<span class="token comment">#授权，kubectl create clusterrolebinding 名称、名称空间、绑定 clusterrole=cluster-admin </span>
kubectl create clusterrolebinding jenkins-k8s-sa-cluster <span class="token parameter variable">-n</span> jenkins-k8s <span class="token parameter variable">--clusterrole</span><span class="token operator">=</span>cluster-admin <span class="token parameter variable">--serviceaccount</span><span class="token operator">=</span>jenkins-k8s:jenkins-k8s-sa
kubectl create clusterrolebinding jenkins-k8s-sa-cluster1 <span class="token parameter variable">-n</span> jenkins-k8s <span class="token parameter variable">--clusterrole</span><span class="token operator">=</span>cluster-admin <span class="token parameter variable">--serviceaccount</span><span class="token operator">=</span>jenkins-k8s:default
kubectl create clusterrolebinding jenkins-k8s-sa-cluster1 <span class="token parameter variable">-n</span> jenkins-0119 <span class="token parameter variable">--clusterrole</span><span class="token operator">=</span>cluster-admin <span class="token parameter variable">--serviceaccount</span><span class="token operator">=</span>jenkins-0119:default
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="部署和验证-jenkins" tabindex="-1"><a class="header-anchor" href="#部署和验证-jenkins" aria-hidden="true">#</a> <strong>部署和验证 Jenkins</strong></h4><div class="language-yaml line-numbers-mode" data-ext="yml"><pre class="language-yaml"><code><span class="token key atrule">apiVersion</span><span class="token punctuation">:</span> apps/v1
<span class="token key atrule">kind</span><span class="token punctuation">:</span> Deployment
<span class="token key atrule">metadata</span><span class="token punctuation">:</span>
  <span class="token key atrule">name</span><span class="token punctuation">:</span> jenkins
  <span class="token key atrule">namespace</span><span class="token punctuation">:</span> jenkins<span class="token punctuation">-</span>k8s
<span class="token key atrule">spec</span><span class="token punctuation">:</span>
  <span class="token key atrule">replicas</span><span class="token punctuation">:</span> <span class="token number">1</span>
  <span class="token key atrule">selector</span><span class="token punctuation">:</span>
    <span class="token key atrule">matchLabels</span><span class="token punctuation">:</span>
      <span class="token key atrule">app</span><span class="token punctuation">:</span> jenkins
  <span class="token key atrule">template</span><span class="token punctuation">:</span>
    <span class="token key atrule">metadata</span><span class="token punctuation">:</span>
      <span class="token key atrule">labels</span><span class="token punctuation">:</span>
        <span class="token key atrule">app</span><span class="token punctuation">:</span> jenkins
    <span class="token key atrule">spec</span><span class="token punctuation">:</span>
      <span class="token key atrule">containers</span><span class="token punctuation">:</span>
        <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> jenkins
          <span class="token key atrule">image</span><span class="token punctuation">:</span> registry.cn<span class="token punctuation">-</span>hangzhou.aliyuncs.com/liuyik8s/jenkins<span class="token punctuation">:</span>2.303.3<span class="token punctuation">-</span>jdk11 
          <span class="token key atrule">imagePullPolicy</span><span class="token punctuation">:</span> IfNotPresent
          <span class="token key atrule">ports</span><span class="token punctuation">:</span>
            <span class="token punctuation">-</span> <span class="token key atrule">containerPort</span><span class="token punctuation">:</span> <span class="token number">8080</span>
              <span class="token key atrule">name</span><span class="token punctuation">:</span> web
              <span class="token key atrule">protocol</span><span class="token punctuation">:</span> TCP
            <span class="token punctuation">-</span> <span class="token key atrule">containerPort</span><span class="token punctuation">:</span> <span class="token number">50000</span>
              <span class="token key atrule">name</span><span class="token punctuation">:</span> agent
              <span class="token key atrule">protocol</span><span class="token punctuation">:</span> TCP
          <span class="token key atrule">resources</span><span class="token punctuation">:</span>
            <span class="token key atrule">limits</span><span class="token punctuation">:</span>
              <span class="token key atrule">cpu</span><span class="token punctuation">:</span> 1000m
              <span class="token key atrule">memory</span><span class="token punctuation">:</span> 1Gi
            <span class="token key atrule">requests</span><span class="token punctuation">:</span>
              <span class="token key atrule">cpu</span><span class="token punctuation">:</span> 500m
              <span class="token key atrule">memory</span><span class="token punctuation">:</span> 500Mi
          <span class="token key atrule">livenessProbe</span><span class="token punctuation">:</span>
            <span class="token key atrule">httpGet</span><span class="token punctuation">:</span>
              <span class="token key atrule">port</span><span class="token punctuation">:</span> <span class="token number">8080</span>
              <span class="token key atrule">path</span><span class="token punctuation">:</span> /login
            <span class="token key atrule">initialDelaySeconds</span><span class="token punctuation">:</span> <span class="token number">60</span>
            <span class="token key atrule">timeoutSeconds</span><span class="token punctuation">:</span> <span class="token number">5</span>
            <span class="token key atrule">failureThreshold</span><span class="token punctuation">:</span> <span class="token number">12</span>
          <span class="token key atrule">readinessProbe</span><span class="token punctuation">:</span>
            <span class="token key atrule">httpGet</span><span class="token punctuation">:</span>
              <span class="token key atrule">port</span><span class="token punctuation">:</span> <span class="token number">8080</span>
              <span class="token key atrule">path</span><span class="token punctuation">:</span> /login
            <span class="token key atrule">initialDelaySeconds</span><span class="token punctuation">:</span> <span class="token number">60</span>
          <span class="token key atrule">volumeMounts</span><span class="token punctuation">:</span>
            <span class="token punctuation">-</span> <span class="token key atrule">mountPath</span><span class="token punctuation">:</span> /var/jenkins_home
              <span class="token key atrule">name</span><span class="token punctuation">:</span> jenkins<span class="token punctuation">-</span>volume
              <span class="token key atrule">subPath</span><span class="token punctuation">:</span> jenkins<span class="token punctuation">-</span>home
      <span class="token key atrule">nodeSelector</span><span class="token punctuation">:</span>
        <span class="token key atrule">jenkins</span><span class="token punctuation">:</span> yes
      <span class="token key atrule">volumes</span><span class="token punctuation">:</span>
        <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> jenkins<span class="token punctuation">-</span>volume
          <span class="token key atrule">persistentVolumeClaim</span><span class="token punctuation">:</span>
            <span class="token key atrule">claimName</span><span class="token punctuation">:</span> jenkins<span class="token punctuation">-</span>pvc
<span class="token punctuation">---</span>
<span class="token key atrule">apiVersion</span><span class="token punctuation">:</span> v1
<span class="token key atrule">kind</span><span class="token punctuation">:</span> Service
<span class="token key atrule">metadata</span><span class="token punctuation">:</span>
  <span class="token key atrule">name</span><span class="token punctuation">:</span> jenkins<span class="token punctuation">-</span>service
  <span class="token key atrule">namespace</span><span class="token punctuation">:</span> jenkins<span class="token punctuation">-</span>k8s
  <span class="token key atrule">labels</span><span class="token punctuation">:</span>
    <span class="token key atrule">app</span><span class="token punctuation">:</span> jenkins
<span class="token key atrule">spec</span><span class="token punctuation">:</span>
  <span class="token key atrule">selector</span><span class="token punctuation">:</span>
    <span class="token key atrule">app</span><span class="token punctuation">:</span> jenkins
  <span class="token key atrule">type</span><span class="token punctuation">:</span> ClusterIP
  <span class="token key atrule">ports</span><span class="token punctuation">:</span>
    <span class="token punctuation">-</span> <span class="token key atrule">port</span><span class="token punctuation">:</span> <span class="token number">8080</span>
      <span class="token key atrule">name</span><span class="token punctuation">:</span> web
      <span class="token key atrule">targetPort</span><span class="token punctuation">:</span> web
    <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> agent
      <span class="token key atrule">port</span><span class="token punctuation">:</span> <span class="token number">50000</span>
      <span class="token key atrule">targetPort</span><span class="token punctuation">:</span> agent
<span class="token punctuation">---</span>
<span class="token key atrule">apiVersion</span><span class="token punctuation">:</span> networking.k8s.io/v1
<span class="token key atrule">kind</span><span class="token punctuation">:</span> Ingress
<span class="token key atrule">metadata</span><span class="token punctuation">:</span>
  <span class="token key atrule">name</span><span class="token punctuation">:</span> jk
  <span class="token key atrule">namespace</span><span class="token punctuation">:</span> jenkins<span class="token punctuation">-</span>k8s
<span class="token key atrule">spec</span><span class="token punctuation">:</span>
  <span class="token key atrule">ingressClassName</span><span class="token punctuation">:</span> nginx
  <span class="token key atrule">rules</span><span class="token punctuation">:</span>
  <span class="token punctuation">-</span> <span class="token key atrule">host</span><span class="token punctuation">:</span> jk.k8s.com
    <span class="token key atrule">http</span><span class="token punctuation">:</span>
      <span class="token key atrule">paths</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> <span class="token key atrule">pathType</span><span class="token punctuation">:</span> Prefix
        <span class="token key atrule">path</span><span class="token punctuation">:</span> <span class="token string">&quot;/&quot;</span>
        <span class="token key atrule">backend</span><span class="token punctuation">:</span>
          <span class="token key atrule">service</span><span class="token punctuation">:</span>
            <span class="token key atrule">name</span><span class="token punctuation">:</span> jenkins<span class="token punctuation">-</span>service
            <span class="token key atrule">port</span><span class="token punctuation">:</span>
              <span class="token key atrule">number</span><span class="token punctuation">:</span> <span class="token number">8080</span>


</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_3-jenkins-初始化配置" tabindex="-1"><a class="header-anchor" href="#_3-jenkins-初始化配置" aria-hidden="true">#</a> 3.<strong>Jenkins 初始化配置</strong></h3><h4 id="查看访问地址" tabindex="-1"><a class="header-anchor" href="#查看访问地址" aria-hidden="true">#</a> <strong>查看访问地址</strong></h4><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>kubectl get svc <span class="token parameter variable">-n</span> jenkins-k8s
 
<span class="token comment">#修改主机 host</span>
<span class="token builtin class-name">echo</span> <span class="token string">&quot;218.76.8.107 jk.k8s.com&quot;</span> <span class="token operator">&gt;</span> /etc/hosts
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="查看初始化用户及密码" tabindex="-1"><a class="header-anchor" href="#查看初始化用户及密码" aria-hidden="true">#</a> <strong>查看初始化用户及密码</strong></h4><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code># 查看 Jenkins 日志,记录初始化密码，填入初始化页面
kubectl logs -n jenkins-k8s jenkins-57c7977bcd-9cf7h
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="登陆系统" tabindex="-1"><a class="header-anchor" href="#登陆系统" aria-hidden="true">#</a> <strong>登陆系统</strong></h4><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token comment"># Ingress 方式访问</span>
http://jk.k8s.com:30880/
<span class="token comment"># Node Port 方式访问</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="初始化用户" tabindex="-1"><a class="header-anchor" href="#初始化用户" aria-hidden="true">#</a> <strong>初始化用户</strong></h4><h4 id="安装中文插件" tabindex="-1"><a class="header-anchor" href="#安装中文插件" aria-hidden="true">#</a> <strong>安装中文插件</strong></h4><h3 id="_4-jenkin-构建环境配置" tabindex="-1"><a class="header-anchor" href="#_4-jenkin-构建环境配置" aria-hidden="true">#</a> <strong>4.Jenkin 构建环境配置</strong></h3><h4 id="cloud-environment-配置" tabindex="-1"><a class="header-anchor" href="#cloud-environment-配置" aria-hidden="true">#</a> <strong>Cloud environment 配置</strong></h4><ol><li><p>可以连接多个云环境</p></li><li><p>连接云中不同的 namespace</p></li><li><p>创建不同的 pod 模板来完成不同的构建任务。</p></li></ol><p>Jenkins 的 kubernetes-plugin 在执行构建时会在 kubernetes 集群中自动创建一个 Pod，并在 Pod 内部创建一个名为 jnlp 的容器，该容器会连接 Jenkins 并运行 Agent 程序，形成一个 Jenkins 的 Master 和 Slave 架构，然后 Slave 会执行构建脚本进行构建。</p><h5 id="安装插件" tabindex="-1"><a class="header-anchor" href="#安装插件" aria-hidden="true">#</a> <strong>安装插件</strong></h5><ol><li>搜索 kubernetes 相关插件, 搜索后安装相应的插件。</li></ol><h5 id="配置-kuberenetes-云环境" tabindex="-1"><a class="header-anchor" href="#配置-kuberenetes-云环境" aria-hidden="true">#</a> <strong>配置 kuberenetes 云环境</strong></h5><p>系统配置-&gt; Cloud</p><blockquote><p>注意 Jenkins pod 的 SA 权限</p></blockquote><h5 id="配置-pod-模板" tabindex="-1"><a class="header-anchor" href="#配置-pod-模板" aria-hidden="true">#</a> <strong>配置 pod 模板</strong></h5><p>/root/.kube：这个目录挂载到容器的/root/.kube 目录下面这是为了让我们能够在 Pod 的容器中能够使用 kubectl 工具来访问我们的 Kubernetes 集群，方便我们后面在 Slave Pod 部署 Kubernetes 应用； 其他两个挂载是为了使用 Docker （DooD 方式) Workspace 使用 PVC，这样不用每次都下载各种库，减少构建的时间</p><p>最终的 slave pod 中使用的卷配置信息。</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code> volumeMounts:
 - mountPath: &quot;/home/jenkins/agent&quot;
 name: &quot;volume-3&quot;
 readOnly: false
 - mountPath: &quot;/var/run/docker.sock&quot;
 name: &quot;volume-0&quot;
 readOnly: false
 - mountPath: &quot;/home/jenkins/agent/.kube&quot;
 name: &quot;volume-1&quot;
 readOnly: false
 - mountPath: &quot;/usr/bin/docker&quot;
 name: &quot;volume-2&quot;
 readOnly: false
 volumes:
 - hostPath:
 path: &quot;/var/run/docker.sock&quot;
 name: &quot;volume-0&quot;
 - hostPath:
 path: &quot;/usr/bin/docker&quot;
 name: &quot;volume-2&quot;
 - hostPath:
 path: &quot;/root/.kube&quot;
 name: &quot;volume-1&quot;
 - emptyDir:
 medium: &quot;&quot;
 name: &quot;workspace-volume&quot;
 - name: &quot;volume-3&quot;
 persistentVolumeClaim:
 claimName: &quot;agent-workspace&quot;
 readOnly: false
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>在每个 step 制定的 docker 名字。</p><h5 id="测试" tabindex="-1"><a class="header-anchor" href="#测试" aria-hidden="true">#</a> <strong>测试</strong></h5><p>使用声明式 Pipeline 创建项目此处的 maven 与上图中标准的要一一对应。如使用 master 则使用 Jenkins Master 进行构建</p><div class="language-groovy line-numbers-mode" data-ext="groovy"><pre class="language-groovy"><code>pipeline <span class="token punctuation">{</span>
    agent <span class="token punctuation">{</span>
      label <span class="token string">&#39;maven&#39;</span> 
         stages <span class="token punctuation">{</span>
           <span class="token function">stage</span><span class="token punctuation">(</span><span class="token string">&#39;拉取代码&#39;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
             steps <span class="token punctuation">{</span>
             		sh <span class="token string">&#39;echo &quot;拉取代码完成&quot; &#39;</span>
             <span class="token punctuation">}</span>
          <span class="token punctuation">}</span>
       <span class="token punctuation">}</span>
    <span class="token punctuation">}</span> 
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="git-连接设置" tabindex="-1"><a class="header-anchor" href="#git-连接设置" aria-hidden="true">#</a> <strong>Git 连接设置</strong></h4><h5 id="github-服务器配置" tabindex="-1"><a class="header-anchor" href="#github-服务器配置" aria-hidden="true">#</a> <strong>GitHub 服务器配置</strong></h5><p>添加凭证 Manage Jenkins-&gt;Manage Credential-&gt;adding</p><h5 id="gitee-服务器配置" tabindex="-1"><a class="header-anchor" href="#gitee-服务器配置" aria-hidden="true">#</a> <strong>Gitee 服务器配置</strong></h5><p>添加凭证 Manage Jenkins-&gt;Manage Credential-&gt;adding 类型为 Username with password</p><h5 id="gitlab-私有服务器配置" tabindex="-1"><a class="header-anchor" href="#gitlab-私有服务器配置" aria-hidden="true">#</a> <strong>GitLab 私有服务器配置</strong></h5><h4 id="image-repository-设置" tabindex="-1"><a class="header-anchor" href="#image-repository-设置" aria-hidden="true">#</a> <strong>Image repository 设置</strong></h4><blockquote><p>Manage Jenkins-&gt;Manage Credential-&gt;adding</p></blockquote><h5 id="docker-hub-配置" tabindex="-1"><a class="header-anchor" href="#docker-hub-配置" aria-hidden="true">#</a> <strong>Docker Hub 配置</strong></h5><h5 id="aliyun-id-配置" tabindex="-1"><a class="header-anchor" href="#aliyun-id-配置" aria-hidden="true">#</a> <strong>Aliyun ID 配置</strong></h5><p>类型为 Username with password</p><h5 id="私有仓库-id-配置" tabindex="-1"><a class="header-anchor" href="#私有仓库-id-配置" aria-hidden="true">#</a> <strong>私有仓库 ID 配置</strong></h5><h3 id="_5-测试上述" tabindex="-1"><a class="header-anchor" href="#_5-测试上述" aria-hidden="true">#</a> <strong>5.测试上述</strong></h3><p>使用 gitee 作为代码管理平台。增加测试的 Pipline 脚本</p><h3 id="_6-图形化界面-blueocean" tabindex="-1"><a class="header-anchor" href="#_6-图形化界面-blueocean" aria-hidden="true">#</a> <strong>6.图形化界面 BlueOcean</strong></h3><p>BlueOcean 是 Jenkins 团队从用户体验角度出发，专为 Jenkins Pipeline 重新设计的一套 UI 界面，仍然兼容以前的 fressstyle 类型的 job，BlueOcean 具有以下的一些特性：连续交付（CD）Pipeline 的复杂可视化，允许快速直观的了解 Pipeline 的状态可以通过 Pipeline 编辑器直观的创建 Pipeline需要干预或者出现问题时快速定位，BlueOcean 显示了 Pipeline 需要注意的地方，便于异常处理和提高生产力用于分支和拉取请求的本地集成可以在 GitHub 或者 Bitbucket 中与其他人进行代码协作时最大限度提高开发人员的生产力。BlueOcean 可以安装在现有的 Jenkins 环境中，也可以使用 Docker 镜像的方式直接运行，我们这里直接在现有的 Jenkins 环境中安装 BlueOcean 插件：登录 Jenkins Web UI -&gt; 点击左侧的 Manage Jenkins -&gt; Manage Plugins -&gt; Available -&gt; 搜索查找 BlueOcean -&gt; 点击下载安装并重启。</p><h2 id="三-jenkins-pipeline" tabindex="-1"><a class="header-anchor" href="#三-jenkins-pipeline" aria-hidden="true">#</a> <strong>三.Jenkins Pipeline</strong></h2><blockquote><p>自 Jenkins 2.0 版本升级之后，支持了通过代码（Groovy DSL）来描述一个构建流水线，灵活方便地实现持续交付，大大提升 Jenkins Job 维护的效率，实现从 CI 到 CD 到转变。而在 2016 Jenkins World 大会上，Jenkins 发布了 1.0 版本的声明式流水线 -Declarative Pipeline，目前已经到发布了 1.2 版本，它是一种新的结构化方式定义一个流水线。</p></blockquote><h3 id="_1-pipeline-特性-pipeline-as-code" tabindex="-1"><a class="header-anchor" href="#_1-pipeline-特性-pipeline-as-code" aria-hidden="true">#</a> <strong>1.Pipeline 特性 - Pipeline As Code</strong></h3><p>Jenkins 从根本上讲是一种支持多种自动化模式的自动化引擎。Pipeline 为其添加了一套强大的自动化工具，支持从简单的持续集成到全面的持续交付。Jenkins Pipeline 特性如下：</p><ul><li><p>代码：Pipeline 以代码的形式描述，通常存储于源代码控制系统，如 Git，使团队能够编辑，审查和迭代其流程定义。</p></li><li><p>持久性：Pipeline 可以在计划和计划外重新启动 Jenkins Master 管理时不被影响。</p></li><li><p>可暂停：Pipeline 可以选择停止并等待人工输入或批准，然后再继续 Pipeline 运行。</p></li><li><p>多功能：Pipeline 支持复杂的项目持续交付要求，包括并行分支/连接，循环和执行 Job 的能力。</p></li><li><p>可扩展：Pipeline 插件支持其 DSL 的自定义扩展以及与其他插件集成。</p></li></ul><p>基于 Jenkins Pipeline，用户可以在一个 JenkinsFile 中快速实现一个项目的从构建、测试以到发布的完整流程，并且可以保存这个流水线的定义。</p><h3 id="_2-pipeline-基本概念" tabindex="-1"><a class="header-anchor" href="#_2-pipeline-基本概念" aria-hidden="true">#</a> <strong>2.Pipeline 基本概念</strong></h3><p>Node: 一个 Node 就是一个 Jenkins 节点，或者是 Master，或者是 Agent，是执行 Step 的具体运行环境，Pipeline 执行中的大部分工作都是在一个或多个声明 Node 步骤的上下文中完成的。</p><p>Stage: 一个 Pipeline 可以从逻辑上划分为若干个 Stage，每个 Stage 代表一组操作，如：Build、Test、Deploy。注意，Stage 是一个逻辑分组的概念，可以跨多个 Node。</p><p>Step: Step 是最基本的操作单元，小到执行一个 Shell 脚本，大到构建一个 Docker 镜像，由各类 Jenkins Plugin 提供，当插件扩展 Pipeline DSL 时，通常意味着插件已经实现#了一个新的步骤。</p><h3 id="_3-scripted-pipeline" tabindex="-1"><a class="header-anchor" href="#_3-scripted-pipeline" aria-hidden="true">#</a> <strong>3.Scripted Pipeline</strong></h3><p>CurrentBuild 可以获取档次执行的结果，可以用于判读后续流程走向，Jenkins 还提供了更多内置环境变量以及 DSL 对象，方便我们操作流水线任务，如：BUILD_ID、JOB_NAME、BRANCH_NAME、CHANGE_ID 等等，可参考 Global Variable。这种方式受 Jenkins 的限制较少，我们可以灵活控制和定义一个流水线，甚至我们可以在 JenkinsFile 中定义多个 Groovy 函数来扩展 Jenkins Pipeline 的能力。</p></div><!--[--><!--]--></div><footer class="page-meta"><!----><div class="meta-item last-updated"><span class="meta-item-label">Last Updated: </span><!----></div><div class="meta-item contributors"><span class="meta-item-label">Contributors: </span><span class="meta-item-info"><!--[--><!--[--><span class="contributor" title="email: huangxiangquan@yintatech.com">huangxiangquan</span><!----><!--]--><!--]--></span></div></footer><nav class="page-nav"><p class="inner"><span class="prev"><a href="/vuepress-starter/devops/kubernetes/k8s-15-%E9%83%A8%E7%BD%B2%E4%B8%AD%E9%97%B4%E4%BB%B6.html" class="" aria-label="部署中间件"><!--[--><!--]--> 部署中间件 <!--[--><!--]--></a></span><span class="next"><a href="/vuepress-starter/devops/kubernetes/k8s-17-Istio%E5%9F%BA%E6%9C%AC%E4%BB%8B%E7%BB%8D.html" class="" aria-label="Istio 入门"><!--[--><!--]--> Istio 入门 <!--[--><!--]--></a></span></p></nav><!--[--><!--]--></main><!--]--></div><!----><!--]--></div>
    <script type="module" src="/vuepress-starter/assets/app-999de8cb.js" defer></script>
  </body>
</html>
